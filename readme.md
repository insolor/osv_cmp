# Программа сравнения оборотно-сальдовых ведомостей

Основное назначение - сравнение оборотно-сальдовых ведомостей при подготовке баз 1С-БГУ к конвертации в Смету-СМАРТ (например, до и после свертки) и при проверке результата конвертации (сравнение оборотно-сальдовой ведомости из 1С и из Сметы-СМАРТ).

## [Скачать](https://bitbucket.org/insolor/osv_cmp/downloads/osv_cmp_gui.7z)

# Настройки формирования оборотно-сальдовых ведомостей

## Настройка в 1С:

* Период - текущий год
* Группировать по:
    * Учреждение - если проверка конвертации нескольких учреждений
    * КФО
    * Счет
    * КПС
* По субсчетам - включено
* Выводить забалансовые счета - включено

## Настройка в Смете-СМАРТ

* Период - текущий год
* Группировка полей:
    * Учреждение - если проверка конвертации нескольких учреждений
    * Виды финансового обеспечения
    * Код счета (6 знаков)
    * КБК
* Выводить забалансовые счета - включить

При сравнении по нескольким учреждениям в Смете до формирования отчета рекомендуется настроить отображение краткого наименования учреждения (меню Настройки - Настройки документов - Общие настройки отчетов - Настройка печати отчетов - снять галку "При печати отчетов выводить полное наименование организации", сохранить, скопировать по всем учреждениям)

При других настройках группировки в 1С и Смете-СМАРТ правильная работа программы не гарантируется.

**Дополнительно:** есть возможность сверять оборотно-сальдовые ведомости ЦБ, для этого нужно включить группировку по учреждениям в 1С и Смете, и поставить ее на верхнем уровне.

# Краткая инструкция

![Скриншот](screenshot.png)

* Запустить программу
* Нажать кнопку `Выбрать файл 1`, выбрать файл (оборотно-сальдовая ведомость до операции - до свертки или до конвертации)
    * Отобразится отчет загрузки файла
* Нажать кнопку `Выбрать файл 2`, выбрать файл (после свертки или после конвертации)
    * Отобразится отчет загрузки файла
* Нажать кнопку `Сравнить`
    * Отобразится сравнительный отчет. Знак `-` обозначает, что что-то было в исходном файле, но отсутствует в ОСВ после изменений. Знак `+` имеет противоположный смысл - что-то добавилось.
    * Некоторые изменения допустимы, например в некоторых счетах в Смете-СМАРТ не будут отображаться остатки на начало года.
    * Сравнение сумм производится с учетом того, что некоторые суммы могут отображаться на "противоположной" колонке (в дебете вместо кредита или наоборот) с противоположным знаком.
* После сравнения можно сохранить полный отчет (отчеты загрузки файлов + отчет сравнения) в текстовый файл, например, для того чтобы его распечатать. Копирование текста из отчета с помощью `Ctrl-C` на данный момент возможно только в английской раскладке, возможно в будущем это будет доработано.
* Кнопка `Загрузить/перечитать` нужна на тот случай, если пути к сравниваемым файлам прописывались вручную, либо если файлы были изменены извне (например, заново выгружены из 1С или Сметы-СМАРТ). После ее нажатия содержимое файлов загружается в программу, заново формируются отчеты о загрузке, отчет о сравнении очищается.

# Возможные доработки (TODO):

* Предупреждение, если ОСВ из 1С выгружена без разделения по субсчетам
* Поддержка формата xlsx

# Последние изменения (на октябрь 2017 года):

* Сравнение ОСВ с группировкой по учреждениям
* Отображение разницы по суммам внутри субсчетов
* Исправлено множество ошибок

# Ссылки

* [О программном комплексе Смета-СМАРТ](http://www.keysystems.ru/products/salary-personnel/EstimateSmart/)
